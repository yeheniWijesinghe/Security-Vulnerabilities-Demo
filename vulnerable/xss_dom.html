<!-- /vulnerable/xss_dom.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Vulnerable DOM XSS</title>
  <style>body{font-family:Arial}</style>
</head>
<body>
  <h2 class="vuln">Vulnerable DOM XSS</h2>
  <p>Append a fragment like <code>#msg=hello</code> or a script to the URL.</p>

  <div id="output"></div>

  <script>
    // UNSAFE: using innerHTML and location.hash directly
    const out = document.getElementById('output');
    const h = location.hash.substring(1); // everything after #
    // naive parse: expect msg=...
    const parts = h.split('=');
    if (parts[0] === 'msg' && parts[1]) {
        out.innerHTML = '<strong>User said:</strong> ' + decodeURIComponent(parts.slice(1).join('='));
    } else {
        out.textContent = 'No message in fragment. Try #msg=hello';
    }
  </script>
</body>
</html>
